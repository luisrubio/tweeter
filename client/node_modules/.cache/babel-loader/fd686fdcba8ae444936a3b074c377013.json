{"ast":null,"code":"var _jsxFileName = \"/Users/luisrubio/code/automate-kaizen/src/components/alarm/Alarm.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport bellAudio from './sounds/bell.mp3';\nimport gameOnAudio from './sounds/game_on.mp3';\nimport strawberryAudio from './sounds/strawberry.mp3';\n\nclass Alarm extends Component {\n  constructor() {\n    super();\n\n    this.fetch = () => {\n      const url = 'http://10.66.1.128:5000'; // get users stats\n\n      axios.get(url + '/api/tokens/ssj').then(res => {\n        this.setState({\n          users: res.data,\n          loading: false\n        });\n      }); // get general info / debug info\n\n      axios.get(url + '/api/tokens/info').then(res => {\n        this.setState({\n          info: res.data\n        });\n      }); // get dog feed info\n\n      axios.get(url + '/api/tokens/cat/4').then(res => {\n        this.setState({\n          catFeed: res.data\n        });\n      }); // get dog walk info\n\n      axios.get(url + '/api/tokens/cat/5').then(res => {\n        this.setState({\n          catWalk: res.data\n        });\n      });\n    };\n\n    this.alarm = () => {\n      this.fetch(); // Clock code\n\n      const addZero = i => {\n        if (i < 10) {\n          i = '0' + i;\n        }\n\n        return i;\n      };\n\n      const clockCode = addZero(this.state.time.getHours()) + '' + addZero(this.state.time.getMinutes()) + '' + addZero(this.state.time.getSeconds());\n      this.setState({\n        time: new Date(),\n        clockCode\n      }); // Sound control\n\n      this.soundControl(parseInt(this.state.clockCode));\n    };\n\n    this.soundControl = n => {\n      console.log(n);\n      let buffer = false;\n\n      if (15000 < Date.now() - this.state.buffer) {\n        buffer = true;\n      } // GAME ON\n\n\n      if (n >= 164300 && n <= 164350 && !this.state.alarmGameOn) {\n        const audio = new Audio(gameOnAudio);\n        audio.play();\n        console.log('playing sound');\n        this.setState({\n          alarmGameOn: true\n        });\n        this.setState({\n          buffer: Date.now()\n        });\n      } // BUS BELL\n      else if (n >= 155900 && n <= 155950 && !this.state.alarmBus1) {\n          const audio = new Audio(bellAudio);\n          audio.play();\n          console.log('playing sound');\n          this.setState({\n            alarmBus1: true\n          });\n        } // DOG FEEDER\n        else if (this.state.catFeed.length > 0 && buffer) {\n            if (!this.state.catFeed[0].completed) {\n              const audio = new Audio(strawberryAudio);\n              audio.play();\n              console.log('playing sound');\n              this.setState({\n                buffer: Date.now()\n              });\n            }\n          } // DOG WALKER\n          else if (this.state.catWalk.length > 0 && buffer) {\n              if (!this.state.catWalk[0].completed) {\n                const audio = new Audio(gameOnAudio);\n                audio.play();\n                console.log('playing sound');\n                this.setState({\n                  buffer: Date.now()\n                });\n              }\n            }\n    };\n\n    this.taskMaster = n => {\n      console.log('taskmaster');\n    };\n\n    this.state = {\n      info: {},\n      users: [],\n      time: new Date(),\n      clockCode: 0,\n      alarmGameOn: false,\n      alarmBus1: false,\n      catFeed: [],\n      catWalk: [],\n      buffer: 0\n    };\n  }\n\n  componentDidMount() {\n    this.fetch();\n    setInterval(() => {\n      this.alarm();\n      this.taskMaster();\n    }, 1000);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default Alarm;","map":{"version":3,"sources":["/Users/luisrubio/code/automate-kaizen/src/components/alarm/Alarm.js"],"names":["React","Component","axios","bellAudio","gameOnAudio","strawberryAudio","Alarm","constructor","fetch","url","get","then","res","setState","users","data","loading","info","catFeed","catWalk","alarm","addZero","i","clockCode","state","time","getHours","getMinutes","getSeconds","Date","soundControl","parseInt","n","console","log","buffer","now","alarmGameOn","audio","Audio","play","alarmBus1","length","completed","taskMaster","componentDidMount","setInterval","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,SAAP,MAAsB,mBAAtB;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AACA,OAAOC,eAAP,MAA4B,yBAA5B;;AAEA,MAAMC,KAAN,SAAoBL,SAApB,CAA8B;AAC5BM,EAAAA,WAAW,GAAG;AACZ;;AADY,SAuBdC,KAvBc,GAuBN,MAAM;AACZ,YAAMC,GAAG,GAAG,yBAAZ,CADY,CAGZ;;AACAP,MAAAA,KAAK,CAACQ,GAAN,CAAUD,GAAG,GAAG,iBAAhB,EAAmCE,IAAnC,CAAwCC,GAAG,IAAI;AAC7C,aAAKC,QAAL,CAAc;AAAEC,UAAAA,KAAK,EAAEF,GAAG,CAACG,IAAb;AAAmBC,UAAAA,OAAO,EAAE;AAA5B,SAAd;AACD,OAFD,EAJY,CAQZ;;AACAd,MAAAA,KAAK,CAACQ,GAAN,CAAUD,GAAG,GAAG,kBAAhB,EAAoCE,IAApC,CAAyCC,GAAG,IAAI;AAC9C,aAAKC,QAAL,CAAc;AAAEI,UAAAA,IAAI,EAAEL,GAAG,CAACG;AAAZ,SAAd;AACD,OAFD,EATY,CAaZ;;AACAb,MAAAA,KAAK,CAACQ,GAAN,CAAUD,GAAG,GAAG,mBAAhB,EAAqCE,IAArC,CAA0CC,GAAG,IAAI;AAC/C,aAAKC,QAAL,CAAc;AAAEK,UAAAA,OAAO,EAAEN,GAAG,CAACG;AAAf,SAAd;AACD,OAFD,EAdY,CAkBZ;;AACAb,MAAAA,KAAK,CAACQ,GAAN,CAAUD,GAAG,GAAG,mBAAhB,EAAqCE,IAArC,CAA0CC,GAAG,IAAI;AAC/C,aAAKC,QAAL,CAAc;AAAEM,UAAAA,OAAO,EAAEP,GAAG,CAACG;AAAf,SAAd;AACD,OAFD;AAGD,KA7Ca;;AAAA,SA8CdK,KA9Cc,GA8CN,MAAM;AACZ,WAAKZ,KAAL,GADY,CAGZ;;AACA,YAAMa,OAAO,GAAGC,CAAC,IAAI;AACnB,YAAIA,CAAC,GAAG,EAAR,EAAY;AACVA,UAAAA,CAAC,GAAG,MAAMA,CAAV;AACD;;AACD,eAAOA,CAAP;AACD,OALD;;AAMA,YAAMC,SAAS,GACbF,OAAO,CAAC,KAAKG,KAAL,CAAWC,IAAX,CAAgBC,QAAhB,EAAD,CAAP,GACA,EADA,GAEAL,OAAO,CAAC,KAAKG,KAAL,CAAWC,IAAX,CAAgBE,UAAhB,EAAD,CAFP,GAGA,EAHA,GAIAN,OAAO,CAAC,KAAKG,KAAL,CAAWC,IAAX,CAAgBG,UAAhB,EAAD,CALT;AAMA,WAAKf,QAAL,CAAc;AACZY,QAAAA,IAAI,EAAE,IAAII,IAAJ,EADM;AAEZN,QAAAA;AAFY,OAAd,EAhBY,CAqBZ;;AACA,WAAKO,YAAL,CAAkBC,QAAQ,CAAC,KAAKP,KAAL,CAAWD,SAAZ,CAA1B;AACD,KArEa;;AAAA,SAuEdO,YAvEc,GAuECE,CAAC,IAAI;AAClBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,UAAIG,MAAM,GAAG,KAAb;;AACA,UAAI,QAAQN,IAAI,CAACO,GAAL,KAAa,KAAKZ,KAAL,CAAWW,MAApC,EAA4C;AAC1CA,QAAAA,MAAM,GAAG,IAAT;AACD,OALiB,CAOlB;;;AACA,UAAIH,CAAC,IAAI,MAAL,IAAeA,CAAC,IAAI,MAApB,IAA8B,CAAC,KAAKR,KAAL,CAAWa,WAA9C,EAA2D;AACzD,cAAMC,KAAK,GAAG,IAAIC,KAAJ,CAAUnC,WAAV,CAAd;AACAkC,QAAAA,KAAK,CAACE,IAAN;AACAP,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,aAAKrB,QAAL,CAAc;AAAEwB,UAAAA,WAAW,EAAE;AAAf,SAAd;AACA,aAAKxB,QAAL,CAAc;AAAEsB,UAAAA,MAAM,EAAEN,IAAI,CAACO,GAAL;AAAV,SAAd;AACD,OAND,CAOA;AAPA,WAQK,IAAIJ,CAAC,IAAI,MAAL,IAAeA,CAAC,IAAI,MAApB,IAA8B,CAAC,KAAKR,KAAL,CAAWiB,SAA9C,EAAyD;AAC5D,gBAAMH,KAAK,GAAG,IAAIC,KAAJ,CAAUpC,SAAV,CAAd;AACAmC,UAAAA,KAAK,CAACE,IAAN;AACAP,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,eAAKrB,QAAL,CAAc;AAAE4B,YAAAA,SAAS,EAAE;AAAb,WAAd;AACD,SALI,CAOL;AAPK,aAQA,IAAI,KAAKjB,KAAL,CAAWN,OAAX,CAAmBwB,MAAnB,GAA4B,CAA5B,IAAiCP,MAArC,EAA6C;AAChD,gBAAI,CAAC,KAAKX,KAAL,CAAWN,OAAX,CAAmB,CAAnB,EAAsByB,SAA3B,EAAsC;AACpC,oBAAML,KAAK,GAAG,IAAIC,KAAJ,CAAUlC,eAAV,CAAd;AACAiC,cAAAA,KAAK,CAACE,IAAN;AACAP,cAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,mBAAKrB,QAAL,CAAc;AAAEsB,gBAAAA,MAAM,EAAEN,IAAI,CAACO,GAAL;AAAV,eAAd;AACD;AACF,WAPI,CAQL;AARK,eASA,IAAI,KAAKZ,KAAL,CAAWL,OAAX,CAAmBuB,MAAnB,GAA4B,CAA5B,IAAiCP,MAArC,EAA6C;AAChD,kBAAI,CAAC,KAAKX,KAAL,CAAWL,OAAX,CAAmB,CAAnB,EAAsBwB,SAA3B,EAAsC;AACpC,sBAAML,KAAK,GAAG,IAAIC,KAAJ,CAAUnC,WAAV,CAAd;AACAkC,gBAAAA,KAAK,CAACE,IAAN;AACAP,gBAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,qBAAKrB,QAAL,CAAc;AAAEsB,kBAAAA,MAAM,EAAEN,IAAI,CAACO,GAAL;AAAV,iBAAd;AACD;AACF;AACF,KAhHa;;AAAA,SAkHdQ,UAlHc,GAkHDZ,CAAC,IAAI;AAChBC,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACD,KApHa;;AAEZ,SAAKV,KAAL,GAAa;AACXP,MAAAA,IAAI,EAAE,EADK;AAEXH,MAAAA,KAAK,EAAE,EAFI;AAGXW,MAAAA,IAAI,EAAE,IAAII,IAAJ,EAHK;AAIXN,MAAAA,SAAS,EAAE,CAJA;AAKXc,MAAAA,WAAW,EAAE,KALF;AAMXI,MAAAA,SAAS,EAAE,KANA;AAOXvB,MAAAA,OAAO,EAAE,EAPE;AAQXC,MAAAA,OAAO,EAAE,EARE;AASXgB,MAAAA,MAAM,EAAE;AATG,KAAb;AAWD;;AACDU,EAAAA,iBAAiB,GAAG;AAClB,SAAKrC,KAAL;AAEAsC,IAAAA,WAAW,CAAC,MAAM;AAChB,WAAK1B,KAAL;AACA,WAAKwB,UAAL;AACD,KAHU,EAGR,IAHQ,CAAX;AAID;;AAiGDG,EAAAA,MAAM,GAAG;AACP,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACD;;AAzH2B;;AA4H9B,eAAezC,KAAf","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport bellAudio from './sounds/bell.mp3';\nimport gameOnAudio from './sounds/game_on.mp3';\nimport strawberryAudio from './sounds/strawberry.mp3';\n\nclass Alarm extends Component {\n  constructor() {\n    super();\n    this.state = {\n      info: {},\n      users: [],\n      time: new Date(),\n      clockCode: 0,\n      alarmGameOn: false,\n      alarmBus1: false,\n      catFeed: [],\n      catWalk: [],\n      buffer: 0\n    };\n  }\n  componentDidMount() {\n    this.fetch();\n\n    setInterval(() => {\n      this.alarm();\n      this.taskMaster();\n    }, 1000);\n  }\n\n  fetch = () => {\n    const url = 'http://10.66.1.128:5000';\n\n    // get users stats\n    axios.get(url + '/api/tokens/ssj').then(res => {\n      this.setState({ users: res.data, loading: false });\n    });\n\n    // get general info / debug info\n    axios.get(url + '/api/tokens/info').then(res => {\n      this.setState({ info: res.data });\n    });\n\n    // get dog feed info\n    axios.get(url + '/api/tokens/cat/4').then(res => {\n      this.setState({ catFeed: res.data });\n    });\n\n    // get dog walk info\n    axios.get(url + '/api/tokens/cat/5').then(res => {\n      this.setState({ catWalk: res.data });\n    });\n  };\n  alarm = () => {\n    this.fetch();\n\n    // Clock code\n    const addZero = i => {\n      if (i < 10) {\n        i = '0' + i;\n      }\n      return i;\n    };\n    const clockCode =\n      addZero(this.state.time.getHours()) +\n      '' +\n      addZero(this.state.time.getMinutes()) +\n      '' +\n      addZero(this.state.time.getSeconds());\n    this.setState({\n      time: new Date(),\n      clockCode\n    });\n\n    // Sound control\n    this.soundControl(parseInt(this.state.clockCode));\n  };\n\n  soundControl = n => {\n    console.log(n);\n    let buffer = false;\n    if (15000 < Date.now() - this.state.buffer) {\n      buffer = true;\n    }\n\n    // GAME ON\n    if (n >= 164300 && n <= 164350 && !this.state.alarmGameOn) {\n      const audio = new Audio(gameOnAudio);\n      audio.play();\n      console.log('playing sound');\n      this.setState({ alarmGameOn: true });\n      this.setState({ buffer: Date.now() });\n    }\n    // BUS BELL\n    else if (n >= 155900 && n <= 155950 && !this.state.alarmBus1) {\n      const audio = new Audio(bellAudio);\n      audio.play();\n      console.log('playing sound');\n      this.setState({ alarmBus1: true });\n    }\n\n    // DOG FEEDER\n    else if (this.state.catFeed.length > 0 && buffer) {\n      if (!this.state.catFeed[0].completed) {\n        const audio = new Audio(strawberryAudio);\n        audio.play();\n        console.log('playing sound');\n        this.setState({ buffer: Date.now() });\n      }\n    }\n    // DOG WALKER\n    else if (this.state.catWalk.length > 0 && buffer) {\n      if (!this.state.catWalk[0].completed) {\n        const audio = new Audio(gameOnAudio);\n        audio.play();\n        console.log('playing sound');\n        this.setState({ buffer: Date.now() });\n      }\n    }\n  };\n\n  taskMaster = n => {\n    console.log('taskmaster');\n  };\n\n  render() {\n    return <div></div>;\n  }\n}\n\nexport default Alarm;\n"]},"metadata":{},"sourceType":"module"}